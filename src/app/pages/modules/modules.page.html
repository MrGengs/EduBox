<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/modules" text="" icon="arrow-back"></ion-back-button>
    </ion-buttons>
    <ion-title>Modul Pembelajaran</ion-title>
    <ion-buttons slot="end">
      <ion-button>
        <ion-icon slot="icon-only" name="notifications-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <!-- Animated Background -->
  <div class="bg-shapes">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <!-- Search Bar -->
  <div class="search-container">
    <ion-searchbar 
      [(ngModel)]="searchQuery" 
      placeholder="Cari modul, topik, atau materi..."
      animated
      debounce="300"
      class="custom-searchbar">
    </ion-searchbar>
  </div>

  <!-- Filter Tags -->
  <div class="filter-tags">
    <ion-chip 
      *ngFor="let category of categories" 
      [color]="currentFilter === category.id ? 'primary' : 'medium'"
      (click)="filterByCategory(category.id)"
      class="ion-no-margin">
      <ion-icon [name]="category.icon" *ngIf="category.icon"></ion-icon>
      <ion-label>{{ category.name }}</ion-label>
    </ion-chip>
  </div>

  <!-- Progress Overview -->
  <ion-card class="progress-card">
    <ion-grid>
      <ion-row>
        <ion-col size="4" class="ion-text-center">
          <div class="stat-number">{{ stats.completed }}</div>
          <div class="stat-label">Modul Selesai</div>
        </ion-col>
        <ion-col size="4" class="ion-text-center">
          <div class="stat-number">{{ stats.inProgress }}</div>
          <div class="stat-label">Sedang Belajar</div>
        </ion-col>
        <ion-col size="4" class="ion-text-center">
          <div class="stat-number">{{ stats.xp }}</div>
          <div class="stat-label">XP Earned</div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-card>

  <!-- Learning Paths -->
  <h2 class="section-title">
    <ion-icon name="layers-outline"></ion-icon>
    <span>Jalur Pembelajaran</span>
  </h2>
  
  <div class="paths-grid">
    <ion-card *ngFor="let path of learningPaths" (click)="openPath(path.id)" class="path-card">
      <ion-icon [name]="path.icon" [color]="path.color" class="path-icon"></ion-icon>
      <ion-card-header>
        <ion-card-title>{{ path.title }}</ion-card-title>
        <ion-card-subtitle>{{ path.description }}</ion-card-subtitle>
      </ion-card-header>
      <ion-progress-bar 
        [color]="path.color" 
        [value]="path.progress / 100">
      </ion-progress-bar>
      <div class="progress-text">{{ path.progress }}% selesai</div>
    </ion-card>
  </div>

  <!-- Modules List -->
  <h2 class="section-title">
    <ion-icon name="book-outline"></ion-icon>
    <span>Modul Tersedia</span>
  </h2>

  <ion-list lines="none" class="modules-list">
    <ion-item *ngFor="let module of filteredModules" (click)="openModule(module.id)" class="module-item">
      <ion-avatar slot="start" class="module-avatar">
        <ion-icon [name]="module.icon" class="module-icon"></ion-icon>
      </ion-avatar>
      <ion-label class="ion-text-wrap">
        <h2>{{ module.title }}</h2>
        <p>{{ module.description }}</p>
        <div class="module-meta">
          <span class="duration">{{ module.duration }}</span>
          <span class="exercises">{{ module.exercises }} latihan</span>
          <span class="rating">‚≠ê {{ module.rating }}</span>
        </div>
        <div class="module-tags">
          <ion-badge color="light" *ngFor="let tag of module.tags">{{ tag }}</ion-badge>
        </div>
      </ion-label>
      <ion-badge [color]="getModuleStatusColor(module.status)" slot="end">
        {{ getModuleStatusText(module.status) }}
      </ion-badge>
    </ion-item>
  </ion-list>
</ion-content>

<!-- AI Assistant Button -->
<ion-fab vertical="bottom" horizontal="end" slot="fixed">
  <ion-fab-button color="primary" (click)="showRandomAchievement()">
    <ion-icon name="sparkles"></ion-icon>
  </ion-fab-button>
</ion-fab>

<!-- Bottom Navigation -->
<ion-tabs>
  <ion-tab-bar slot="bottom" class="bottom-nav">
    <ion-tab-button tab="home" (click)="navigateTo('home')">
      <ion-icon name="home-outline"></ion-icon>
      <ion-label>Beranda</ion-label>
    </ion-tab-button>
    <ion-tab-button tab="workspace" (click)="navigateTo('workspace')">
      <ion-icon name="cube-outline"></ion-icon>
      <ion-label>3D Space</ion-label>
    </ion-tab-button>
    <ion-tab-button tab="coding" (click)="navigateTo('coding')">
      <ion-icon name="code-slash-outline"></ion-icon>
      <ion-label>Coding</ion-label>
    </ion-tab-button>
    <ion-tab-button tab="modules" selected>
      <ion-icon name="book-outline"></ion-icon>
      <ion-label>Modul</ion-label>
    </ion-tab-button>
    <ion-tab-button tab="profile" (click)="navigateTo('profile')">
      <ion-icon name="person-outline"></ion-icon>
      <ion-label>Profil</ion-label>
    </ion-tab-button>
  </ion-tab-bar>
</ion-tabs>
